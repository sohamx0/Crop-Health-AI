# ğŸŒ± Crop Health Diagnosis & Fertilizer Recommendation System

An AI-driven web application for real-time crop disease detection and fertilizer recommendations using deep learning and large language models.


## ğŸ“Œ Overview

This system detects plant diseases from leaf images using a **ResNet50 CNN model** and generates **actionable fertilizer recommendations** using the **Gemini Large Language Model (LLM)**.  
It is designed to be lightweight, fast, and usable directly by farmers via a mobile-friendly web interface.

## ğŸš€ Features

- Image-based plant disease detection (38 disease classes)
- Deep Learning using ResNet50 (TensorFlow/Keras)
- Fertilizer recommendations via Gemini LLM
- Real-time inference (200â€“400 ms on CPU)
- Flask-based REST API
- No authentication, no database, no data storage
- Privacy-first, in-memory image processing

## ğŸ§  Tech Stack

- Python  
- Flask  
- TensorFlow / Keras  
- ResNet50 (Transfer Learning)  
- Gemini LLM  
- HTML, TailwindCSS, JavaScript  

## ğŸ— System Architecture

- **Client**: Image upload + result display (Web UI)
- **Backend**: Flask API for preprocessing, inference & LLM calls
- **Model Layer**: Fine-tuned ResNet50 CNN

No database or persistent storage is used.

### Project Structure

```
Crop-Health-AI/
â”œâ”€â”€ app.py                      # Flask application & API endpoints
â”œâ”€â”€ plant_disease_model.h5      # Pre-trained ResNet50 model
â”œâ”€â”€ requirements.txt            # Python dependencies
â”œâ”€â”€ templates/                  # HTML templates
â”‚   â”œâ”€â”€ index.html             # Main UI
â”‚   â”œâ”€â”€ library.html           # Disease library
â”‚   â””â”€â”€ vision_checker.html    # Vision checker page
â”œâ”€â”€ static/                     # Static assets (CSS, JS)
â”œâ”€â”€ assets/                     # Image assets
â””â”€â”€ .env                        # Environment variables (create this)
```

## ğŸ”¬ Model Details

- Dataset: PlantVillage
- Input size: 224 Ã— 224
- Output: Multi-class disease prediction
- Activation: Softmax

### Model Accuracy Comparison

| Model          | Accuracy |
|----------------|----------|
| EfficientNetB0 | 97.16%   |
| **ResNet50**   | 97.86%   |
| Custom CNN     | 95.84%   |
| MobileNetV2    | 93.80%   |

ResNet50 was selected for deployment due to accuracyâ€“speed balance.


## ğŸŒ¾ Fertilizer Recommendation

- Generated using Gemini LLM
- Input: Crop type + predicted disease
- Output: Fertilizers, dosages, and preventive steps
- Human-readable, no rule-based logic


## ğŸ” Workflow

1. User uploads a leaf image  
2. Image sent to `/predict_disease` endpoint  
3. Image preprocessing (resize, normalize)  
4. Disease prediction via ResNet50  
5. Fertilizer advice generated by Gemini LLM  
6. Response returned as JSON  
7. Image discarded from memory  


## âš™ï¸ Installation & Setup

### Prerequisites

- Python 3.9 or higher
- Gemini API key (for fertilizer recommendations)

### Step 1: Clone the Repository

```bash
git clone https://github.com/sohamx0/Crop-Health-AI.git
cd Crop-Health-AI
```

### Step 2: Install Dependencies

```bash
pip install -r requirements.txt
```

### Step 3: Configure Gemini API Key

1. Get your Gemini API key from [Google AI Studio](https://makersuite.google.com/app/apikey)
2. Create a `.env` file in the root directory:
   ```bash
   GEMINI_API_KEY=your_actual_api_key_here
   ```
3. The `.env` file is already in `.gitignore`, so your API key won't be committed to GitHub.

> **Note**: Disease detection will work without the API key, but fertilizer recommendations require it.

### Step 4: Run the Application

```bash
python app.py
```

The application will start on `http://127.0.0.1:5000/`

Open in your browser:
```
http://127.0.0.1:5000/
```
## ğŸ“¡ API Endpoints

- `POST /predict_disease` - Upload image and get disease prediction + fertilizer recommendation
- `GET /` - Main application interface
- `GET /library` - Disease library with sample images

## ğŸ›£ Future Scope

- Weather & soil sensor integration
- Offline inference mode
- Multilingual native UI
- IoT-based monitoring
- Region-specific retraining

## ğŸ¤ Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## ğŸ“œ License

MIT License

## ğŸ‘¤ Author

[sohamx0](https://github.com/sohamx0)
